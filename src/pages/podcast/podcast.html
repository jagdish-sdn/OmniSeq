<ion-header>
  <ion-navbar>
    <ion-title>Podcast</ion-title>
  </ion-navbar>
  <!-- <ion-searchbar [(ngModel)]="searchText.title" (ionInput)="searchepisode(searchText.title)" debounce=500 placeholder="Search Podcast Episode"></ion-searchbar> -->
</ion-header>
<ion-content class="body-content">
  <ion-row>
    <ion-searchbar [(ngModel)]="searchText.title" (ionInput)="searchepisode(searchText.title)" debounce=500 placeholder="Search Podcast Episode"></ion-searchbar>
  </ion-row>
  <ion-scroll style="width:100%;height:100vh" scrollY="true">
    <ion-list scroll="true">
      <ion-item class="settingBtn" *ngFor="let podcast of podcasts; let i=index;">
        <ion-avatar (click)="currentTrack = podcast;playAudio(i);inItTrack = true;" item-left>
          <img src="{{podcast.art}}">
        </ion-avatar>
        <p (click)="goToPodcastDetail(podcast)" class="topic-title">{{podcast.title}}</p>
        <span class="uploaded">{{podcast.date}}</span>
        <p (click)="goToPodcastDetail(podcast)" class="topic-desc">{{podcast.desc}}</p>
        <span (click)="downloadfile(podcast.contentUrl, i)" *ngIf="podcast.isDownloaded == false">
          <ion-icon class="down-icon" name="md-download"></ion-icon>
        </span>
        <span (click)="deletefile(podcast.contentUrl, i, podcast.contentUrl)" *ngIf="podcast.isDownloaded == true">
          <ion-icon class="down-icon" name="md-trash"></ion-icon>
        </span>&nbsp;&nbsp;
        <span class="duration">{{millisToMinutesAndSeconds(podcast.totalDuration)}}</span>
      </ion-item>
    </ion-list>
  </ion-scroll>
  <div *ngIf="showMe">
    <ion-list padding *ngIf="podcasts.length == 0">
      <ion-item style="border-bottom:0 !important;" class="noRecordFoundImg" padding-top>
        <img class="noRecordFound">
      </ion-item>
    </ion-list>
  </div>
  <ion-infinite-scroll *ngIf="podcasts.length !== totalRecords" (ionInfinite)="doInfinite($event)">
    <ion-infinite-scroll-content></ion-infinite-scroll-content>
  </ion-infinite-scroll>
</ion-content>
<ion-footer *ngIf="currentPlay.title">
  <ion-toolbar>
    <ion-item class="footer-item">
      <ion-avatar class="footer-avt" item-left>
        <img src="{{currentPlay.art}}">
      </ion-avatar>
      <p class="topic-title-play">{{currentPlay.title}}</p>
      <audio-track #audioTrack [track]="currentTrack" [autoplay]="true" (onFinish)="onTrackFinished($event)">
        <div style="display: flex">
          <audio-track-progress-bar *ngIf="audioTrack && !audioTrack.isLoading" duration progress [audioTrack]="audioTrack" style="width: 100%;margin-right: 10%;"></audio-track-progress-bar>
        </div>
        <div style="display: flex;">
          <ion-spinner *ngIf="audioTrack && audioTrack.isLoading"></ion-spinner>
        </div>
        <div class="play-icon">
          <ion-icon ios="ios-play" md="md-play" *ngIf="!trackPlay && !inItTrack" (click)="playMe();playPauseSong();inItTrack = true;"></ion-icon>
          <ion-icon ios="ios-play" md="md-play" *ngIf="!trackPlay && inItTrack" (click)="playPauseSong();audioTrack.play()"></ion-icon>
          <ion-icon ios="ios-pause" md="md-pause" id='yourId' *ngIf="trackPlay" (click)="playPauseSong();audioTrack.pause()"></ion-icon>
        </div>
      </audio-track>
    </ion-item>
  </ion-toolbar>
</ion-footer>